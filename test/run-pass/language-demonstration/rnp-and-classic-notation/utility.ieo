export (bal)

# find first position of string x in string s, but only if it's not between l and r
# where x, l, r - characters
fun bal(x, s, l, r) {
    pos = 0;
    i = 0;
    while(pos < len(s)) {
        char = cut(pos, pos + 1, s);
        if(char == "l") { i = i + 1; }
        if(char == "r") { i = i - 1; }
        if(char == "x") {
            if(i == 0) { return pos; }
        }
    }
    return fail none;
}
